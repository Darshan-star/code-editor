<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Editor</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <style type="text/css" media="screen">
    body {
        overflow: hidden;
    }

    #editor {
        min-width: 500px;
        min-height: 500px;
    }
  </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>

<div class="container" style=" margin-top: 30px;">
    <div class="row">
        <div class="col">
<pre id="editor">
public class Main{
  public static void main(String[] args){
       System.out.println("Hello World!");
       //Your Code here
  }
}
</pre>
        </div>
        <div class="col">
            <button class="btn btn-success">Execute</button>
            <br/>
            <pre id="ans"></pre>

    </div>
</div>


<script src="src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    // editor.setTheme("ace/theme/twilight");
    editor.session.setMode("ace/mode/python");

    $(document).ready(function(){
      $("button").click(function(){
        let code = editor.getValue();
        $("#ans").html("Loading...");
        console.log(code);
        let data = {
          "source_code": code,
          "language_id": "62",
          "number_of_runs": "1",
          "stdin": "Judge0",
          "expected_output": null,
          "cpu_time_limit": "2",
          "cpu_extra_time": "0.5",
          "wall_time_limit": "5",
          "memory_limit": "128000",
          "stack_limit": "64000",
          "max_processes_and_or_threads": "60",
          "enable_per_process_and_thread_time_limit": false,
          "enable_per_process_and_thread_memory_limit": false,
          "max_file_size": "1024"
        };
        let request = $.ajax({
          url: "http://134.209.156.1/submissions",
          type: "post",
          data: data
        });
        const delay = ms => new Promise(res => setTimeout(res, ms));
        // Callback handler that will be called on success
        request.done(async function (response, textStatus, jqXHR){
          // Log a message to the console
          console.log("Hooray, it worked!");
          let token = response.token;
          await new Promise(resolve => setTimeout(resolve,5000)); // 3 sec
          console.log(3, "after 3 second");
          let second_request = $.ajax({
            url: "http://134.209.156.1/submissions/" + token,
            type: "get"
          });
          second_request.done(function(response) {
            console.log(response.stdout);
            $("#ans").html(response.stdout);
          })



        });
      });
    });

</script>

</body>
</html>
